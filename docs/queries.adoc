= Requests queries


[source]
----
curl https://platform.microservices.io/prod/graphql  \
--user accessKeyId:accessKeySecret \
--data-binary '{"query":"query { user { applications { name }, organizations { name } }}"}'
----

== Queries


=== Retrieve information about the user and their organizations and applications
[source]
----
{
    "query": "query { 
        user { applications { name }, organizations { name }}
    }"
}
----


=== Retrieve user applications
[source]
----
{
    "query": "query {
        applications { id, name, created, modified }
    }"
}
----


=== Retrieve applications in organization with the last completed assessments
[source]
----
{
    "query": "query
        applications($organization: String) {
            applications(organization: $organization) {
                name,
                latestCompletedAssessment {
                    name,
                    topLevelScore,
                    answers { section, score, answers { question, answer } }
                }
            }
        }",
    "variables": { "organization": "My Organization" }
}
----


=== Retrieve applications list by name
[source]
----
{
    "query": "query
        application($name: String!) {
            application(name: $name) {
                id, name, created, modifiedm
                services {
                    id, name, created, modified,
                    assessments {
                        name,
                        topLevelScore,
                        answers { section, score, answers { question, answer } }
                    },
                    latestCompletedAssessment {
                        name,
                        topLevelScore,
                        answers { section, score, answers { question, answer } }
                    },
                    application { id, name }
                },
                assessments {
                    name,
                    topLevelScore,
                    answers { section, score, answers { question, answer } }
                },
                latestCompletedAssessment {
                    name,
                    topLevelScore,
                    answers { section, score, answers { question, answer } }
                }
            }
        }",
    "variables": { "name": "Example application" }
}
----


=== Retrieve a single application by name
[source]
----
{
    "query": "query
        uniqueApplication($name: String!) {
            uniqueApplication(name: $name) {
                id, name, created, modified
            }
        }",
    "variables": { "name": "Example application" }
}
----


=== Retrieve application by ID
[source]
----
{
    "query": "query
        applicationById($id: String!) {
            applicationById(id: $id) { id,name, created, modified }
        }",
    "variables":{ "id": "f3afc470-fc2a-11ea-87a7-b360a6f25f3a" }
}
----


=== Retrieve organizations list
[source]
----
{
    "query": "query {
        organizations { name, applications { id, name, created, modified } }
    }"
}
----


=== Retrieve organization by name
[source]
----
{
    "query": "query organization($name: String!) {
        organization(name: $name) { id, name, created, modified }
    }",
    "variables": { "name":"My organization" }
}
----


== Mutations


=== Create application
[source]
----
{
    "query": "mutation CreateApplicationForUserMutation($name: String) {
        createApplicationForUser(name: $name) { id }
    }",
    "variables": { "name":"Example application" }
}
----


=== Create application in organization
[source]
----
{
    "query": "mutation CreateApplicationInOrganizationMutation($organization: String, $name: String) {
        createApplicationInOrganization(organization: $organization, name: $name) { id }
    }",
    "variables":{
        "name": "My application",
        "organization": "My Organization"
    }
}
----


=== Create service
[source]
----
{
    "query": "mutation CreateServiceForUserMutation($serviceName: String, $applicationName: String) {
        CreateServiceForUserMutation(serviceName: $serviceName, applicationName: $applicationName) { id } }",
    "variables": {
        "serviceName": "My Service",
        "applicationName": "My Application"
    }
}
----


=== Create service in organization
[source]
----
{
    "query": "mutation createServiceInOrganization($organization: String, $applicationName: String, $serviceName: String) {
        createServiceInOrganization($organization: String, applicationName: $applicationName, serviceName: $serviceName) { id }
    }",
    "variables": {
        "organization": "My Organization",
        "applicationName": "My Application",
        "serviceName": "My Service"
    }
}
----
